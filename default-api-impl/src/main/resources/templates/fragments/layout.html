<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <title layout:title-pattern="$CONTENT_TITLE - DV Config">DV Config</title>
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
        .navbar { box-shadow: 0 2px 4px rgba(0,0,0,.1); background-color: #343a40 !important; }
        .navbar-brand { font-weight: bold; letter-spacing: 1px; }
        .card { border: none; box-shadow: 0 0.125rem 0.25rem rgba(0,0,0,.075); margin-bottom: 20px; border-radius: 0.5rem; }
        .card-header { background-color: #fff; border-bottom: 1px solid rgba(0,0,0,.05); font-weight: 600; border-radius: 0.5rem 0.5rem 0 0 !important; }
        .table th { font-weight: 600; color: #495057; background-color: #f8f9fa; border-top: none; }
        .btn-icon { padding: 0.25rem 0.5rem; }
        .status-badge { font-size: 0.8em; font-weight: 500; }
        .desc-cell { max-width: 200px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .toast-container { position: fixed; top: 20px; right: 20px; z-index: 1060; }
        .operation-badge { width: 80px; display: inline-block; text-align: center; }

        /* Diff Styles */
        .diff-container { background: #fff; border: 1px solid #ddd; border-radius: 4px; margin-bottom: 20px; }
        .diff-header { padding: 10px 15px; background: #f1f3f5; border-bottom: 1px solid #ddd; font-weight: bold; display: flex; justify-content: space-between; }
        .diff-body { display: flex; }
        .diff-pane { flex: 1; padding: 10px; font-family: monospace; white-space: pre-wrap; word-break: break-all; font-size: 0.9em; }
        .diff-pane.old { border-right: 1px solid #eee; background-color: #fff5f5; color: #c00; }
        .diff-pane.new { background-color: #f0fff4; color: #0a0; }
        .diff-pane.empty { background-color: #f8f9fa; color: #aaa; }
        .diff-type-badge { font-size: 0.8em; text-transform: uppercase; }

        /* Loading Overlay */
        #loadingOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.7); z-index: 9999; display: none; justify-content: center; align-items: center; }
    </style>
    <th:block layout:fragment="css"></th:block>
</head>
<body>

<div id="loadingOverlay">
    <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
</div>

<nav class="navbar navbar-expand-lg navbar-dark mb-4">
    <div class="container">
        <a class="navbar-brand" href="#"><i class="fas fa-cogs me-2"></i><span th:text="#{app.title}">DV Config</span></a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav me-auto">
                <li class="nav-item">
                    <a th:class="${activeMenu == 'config' ? 'nav-link active' : 'nav-link'}"
                       href="/admin/config"><i class="fas fa-list me-1"></i><span th:text="#{nav.config}">Config</span></a>
                </li>
                <li class="nav-item">
                    <a th:class="${activeMenu == 'config-drafts' ? 'nav-link active' : 'nav-link'}"
                       href="/admin/config/drafts"><i class="fas fa-edit me-1"></i><span th:text="#{nav.config.drafts}">Drafts</span></a>
                </li>
                <li class="nav-item">
                    <a th:class="${activeMenu == 'config-history' ? 'nav-link active' : 'nav-link'}"
                       href="/admin/config/history"><i class="fas fa-history me-1"></i><span th:text="#{nav.config.history}">History</span></a>
                </li>
                <li class="nav-item">
                    <a th:class="${activeMenu == 'route' ? 'nav-link active' : 'nav-link'}"
                       href="/admin/route"><i class="fas fa-route me-1"></i><span th:text="#{nav.route}">Route</span></a>
                </li>
                <li class="nav-item">
                    <a th:class="${activeMenu == 'route-drafts' ? 'nav-link active' : 'nav-link'}"
                       href="/admin/route/drafts"><i class="fas fa-edit me-1"></i><span th:text="#{nav.route.drafts}">Drafts</span></a>
                </li>
                <li class="nav-item">
                    <a th:class="${activeMenu == 'route-history' ? 'nav-link active' : 'nav-link'}"
                       href="/admin/route/history"><i class="fas fa-history me-1"></i><span th:text="#{nav.route.history}">History</span></a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="container" layout:fragment="content">
    <!-- Content will be replaced here -->
</div>

<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
<script>
    function showToast(message, type = 'success') {
        const toastHtml = `
            <div class="toast align-items-center text-white bg-${type} border-0" role="alert" aria-live="assertive" aria-atomic="true">
                <div class="d-flex">
                    <div class="toast-body">
                        ${message}
                    </div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
                </div>
            </div>
        `;
        const toastEl = $(toastHtml);
        $('.toast-container').append(toastEl);
        const toast = new bootstrap.Toast(toastEl[0]);
        toast.show();
        toastEl.on('hidden.bs.toast', function () {
            $(this).remove();
        });
    }

    $(document).ajaxStart(function() {
        $('#loadingOverlay').css('display', 'flex');
    }).ajaxStop(function() {
        $('#loadingOverlay').hide();
    });
</script>
<th:block layout:fragment="scripts"></th:block>
</body>
</html>
